---
title: "Dockerã«ã‚ˆã‚‹Windowsä¸Šã§ã®æ©Ÿæ¢°å­¦ç¿’ç’°å¢ƒæ§‹ç¯‰"
emoji: "ğŸ˜Š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Python", "æ©Ÿæ¢°å­¦ç¿’", "Docker"]
published: false
---

# æ¦‚è¦

æœ¬è¨˜äº‹ã§ã¯ï¼ŒWindows 11 ä¸Šã« Docker ã‚’ç”¨ã„ã¦æ©Ÿæ¢°å­¦ç¿’ã®ãŸã‚ã®ç’°å¢ƒæ§‹ç¯‰ã‚’è¡Œã†ï¼
ãªãŠï¼ŒNvidia ã® GPU ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’æƒ³å®šã™ã‚‹ï¼

ä»¥ä¸‹ 2 ã¤ã®æ©Ÿæ¢°å­¦ç¿’ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã¤ã„ã¦ï¼Œãã‚Œãã‚Œç’°å¢ƒæ§‹ç¯‰æ–¹æ³•ã‚’èª¬æ˜ã™ã‚‹ï¼

- `TensorFlow`
- `PyTorch`

# å…±é€šã§å¿…è¦ãªæ‰‹é †

æœ¬ç« ã§ã¯ï¼Œã„ãšã‚Œã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚‚å¿…è¦ãªæ‰‹é †ã‚’ç¤ºã™ï¼

å¤§ã¾ã‹ã«ã¯ï¼Œä»¥ä¸‹ã®æ‰‹é †ã§ã‚ã‚‹ï¼

1. WSL2 ã‚’ç”¨ã„ã¦ Ubuntu ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
1. Docker Desktop ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
1. NVIDIA Container Toolkit ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãªãŠï¼Œ**Windows ä¸Šã« GPU ãƒ‰ãƒ©ã‚¤ãƒãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã¯å‰æã¨ã™ã‚‹ï¼**

## WSL2ï¼ŒUbuntu ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Docker ã¯ WSL2 ä¸Šã® Linux ã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«å‹•ä½œã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ï¼Œã¾ãš WSL ã¨ Ubuntu ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ï¼
[WSL ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« | Microsoft Learn](https://learn.microsoft.com/ja-jp/windows/wsl/install)

## Docker Desktop ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[Windows | Docker Docks](https://docs.docker.com/desktop/setup/install/windows-install/)

## NVIDIA Container Toolkit ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

WSL2 ä¸Šã® Ubuntu ã«ï¼ŒNVIDIA Container Toolkit ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ï¼
[Installing the NVIDIA Container Toolkit](https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html)

# ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ¯ã®æ‰‹é †

## TensorFlow ã®ç’°å¢ƒæ§‹ç¯‰

ã¯ã˜ã‚ã«ï¼Œãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã‚’ç¤ºã™ï¼
```
.
â”œâ”€â”€ .devcontainer/
â”‚   â””â”€â”€ devcontainer.json
â”œâ”€â”€ Dockerfile
â””â”€â”€ src/
    â”œâ”€â”€ hoge.py
    â””â”€â”€ fuga.ipynb
```

`src/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ï¼Œã‚³ãƒ¼ãƒ‰æœ¬ä½“ãŒé…ç½®ã•ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã‚ã‚‹ï¼
ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ï¼Œã‚³ãƒ³ãƒ†ãƒŠã«ãƒã‚¦ãƒ³ãƒˆã—ã¦ä½¿ã†ï¼

`Dockerfile`ã¯Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’ã¤ãã‚‹ã®ã«å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã‚‹ï¼
ã“ã‚Œã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¿°ã™ã‚‹ï¼
```Dockerfile:Dockerfile
FROM tensorflow/tensorflow:2.17.0-gpu-jupyter

RUN apt-get update && apt-get install -y python3-pip git

RUN python3 -m pip install --upgrade pip && \
    python3 -m pip install --no-cache-dir pandas numpy matplotlib scikit-learn seaborn

RUN apt-get autoremove -y && \
    apt-get clean && \
    rm -rf /usr/local/src/*

WORKDIR /work
```

æ¬¡ã«ï¼Œ`.devcontainer/devcontainer.json`ã‚’ç·¨é›†ã™ã‚‹ï¼
ã“ã‚Œã¯ï¼ŒVisual Studio Codeã§ã‚³ãƒ³ãƒ†ãƒŠã‚’æ§‹æˆã™ã‚‹ã®ã«å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã‚‹ï¼
```json:.devcontainer/devcontainer.json
{
    "name": "tf",
    "build": {
        "dockerfile": "../Dockerfile"
    },
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python",
                "ms-toolsai.jupyter"
            ]
        }
    },
    "workspaceFolder": "/work",
    "workspaceMount": "source=${localWorkspaceFolder}/src,target=/work,type=bind",
    "runArgs": [
        "--gpus",
        "all"
    ]
}
```

ã“ã“ã¾ã§å®Œäº†ã—ãŸã‚‰ï¼ŒVSCodeã§ã‚³ãƒãƒ³ãƒ‰ãƒ‘ãƒ¬ãƒƒãƒˆã‚’é–‹ãï¼ˆ`Ctrl` + `Shift` + `P`ï¼‰ï¼Œ`Reopen in Container`ã‚’æ¤œç´¢ã—ã¦é¸æŠã™ã‚‹ï¼
ã“ã‚Œã«ã‚ˆã£ã¦ï¼Œè‡ªå‹•çš„ã«ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ“ãƒ«ãƒ‰ãŒå§‹ã¾ã‚Šï¼Œå®Œäº†æ¬¡ç¬¬ã‚³ãƒ³ãƒ†ãƒŠã§Reopenã—ã¦ãã‚Œã‚‹ï¼

å‚è€ƒ
- [Docker - TensorFlow](https://www.tensorflow.org/install/docker?hl=ja)
- [Developing inside a Container](https://code.visualstudio.com/docs/devcontainers/containers)

## PyTorchã®ç’°å¢ƒæ§‹ç¯‰

To be written
